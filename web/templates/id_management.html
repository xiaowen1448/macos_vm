<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MacOS VM 虚拟机管理平台 - ID管理</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .sidebar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 2px 0 15px rgba(102, 126, 234, 0.3);
            min-height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
            width: 280px;
            color: white;
        }
        
        .accordion-button:not(.collapsed) {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            box-shadow: none;
        }
        
        .accordion-button {
            background: transparent;
            color: white;
            border: none;
            box-shadow: none;
            font-weight: 600;
        }
        
        .accordion-button:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .accordion-button:focus {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            box-shadow: none;
        }
        
        .accordion-button::after {
            filter: invert(1);
        }
        
        .nav-link {
            color: rgba(255, 255, 255, 0.8);
            padding: 12px 20px;
            border-radius: 8px;
            margin: 4px 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            transform: translateX(5px);
        }
        
        .nav-link.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .accordion-item {
            background: transparent;
            border: none;
        }
        
        .accordion-body {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin: 0 8px;
        }
        
        .card {
            border: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 10px;
        }
        
        .card-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px 10px 0 0 !important;
            padding: 20px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            font-weight: 600;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .table {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .table thead th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px;
            font-weight: 600;
        }
        
        .table tbody tr:hover {
            background-color: rgba(102, 126, 234, 0.1);
        }
        
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .status-active {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-inactive {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .main-content {
            margin-left: 280px;
            padding: 20px;
        }
        
        .page-header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .stats-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .stats-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
        }
        
        .stats-label {
            color: #6c757d;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
    </style>
</head>
<body>
    <!-- 语言切换和登出按钮 -->
    <div class="d-flex align-items-center" style="position:absolute; top:18px; right:120px; z-index:2000;">
        <div class="dropdown">
            <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="langDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                语言
            </button>
            <ul class="dropdown-menu" aria-labelledby="langDropdown">
                <li><a class="dropdown-item" href="?lang=zh">中文</a></li>
                <li><a class="dropdown-item" href="?lang=en">English</a></li>
            </ul>
        </div>
    </div>
    <a href="{{ url_for('logout') }}" class="btn btn-outline-secondary position-absolute" style="top: 18px; right: 32px; z-index: 2000;">登出</a>

    <!-- 侧边栏 -->
    <nav class="sidebar p-3">
        <div class="sidebar-header text-center mb-4">
            <h4 class="mb-0">
                <span class="brand-text">MacOS VM 虚拟机管理平台</span>
            </h4>
        </div>
        <div class="accordion" id="accordionMenu">
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingVM">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseVM" aria-expanded="false" aria-controls="collapseVM">
                        虚拟机管理
                    </button>
                </h2>
                <div id="collapseVM" class="accordion-collapse collapse" aria-labelledby="headingVM" data-bs-parent="#accordionMenu">
                    <div class="accordion-body p-0">
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('clone_vm_page') }}">虚拟机批量克隆</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('vm_management_page') }}">虚拟机信息管理</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('vm_info_page') }}">虚拟机成品管理</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('vm_script_page') }}">虚拟机脚本管理</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingBoot">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseBoot" aria-expanded="false" aria-controls="collapseBoot">
                            登录引导管理
                        </button>
                </h2>
                <div id="collapseBoot" class="accordion-collapse collapse show" aria-labelledby="headingBoot" data-bs-parent="#accordionMenu">
                    <div class="accordion-body p-0">
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('wuma_page') }}">虚拟机五码管理</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('mupan_page') }}">虚拟机母盘管理</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="{{ url_for('id_management_page') }}">ID管理</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- 其他菜单项 -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingEncrypt">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEncrypt" aria-expanded="false" aria-controls="collapseEncrypt">
                        数据加密功能
                    </button>
                </h2>
                <div id="collapseEncrypt" class="accordion-collapse collapse" aria-labelledby="headingEncrypt" data-bs-parent="#accordionMenu">
                    <div class="accordion-body p-0">
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('encrypt_code_page') }}">代码加密</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('encrypt_wuma_page') }}">五码加密</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('encrypt_id_page') }}">id加密</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingProxy">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseProxy" aria-expanded="false" aria-controls="collapseProxy">
                        代理ip配置
                    </button>
                </h2>
                <div id="collapseProxy" class="accordion-collapse collapse" aria-labelledby="headingProxy" data-bs-parent="#accordionMenu">
                    <div class="accordion-body p-0">
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('proxy_assign_page') }}">代理ip分配</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingSoft">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSoft" aria-expanded="false" aria-controls="collapseSoft">
                        虚拟机软件管理
                    </button>
                </h2>
                <div id="collapseSoft" class="accordion-collapse collapse" aria-labelledby="headingSoft" data-bs-parent="#accordionMenu">
                    <div class="accordion-body p-0">
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('soft_version_page') }}">版本查看</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('soft_env_page') }}">环境变量</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingSystem">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSystem" aria-expanded="false" aria-controls="collapseSystem">
                        系统管理
                    </button>
                </h2>
                <div id="collapseSystem" class="accordion-collapse collapse" aria-labelledby="headingSystem" data-bs-parent="#accordionMenu">
                    <div class="accordion-body p-0">
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link" href="#">系统版本</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">系统插件管理</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">用户管理</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">授权管理</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- 主内容区域 -->
    <div class="main-content">
        <!-- 页面标题 -->
        <div class="page-header">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="mb-2"><i class="fas fa-id-card me-3"></i>ID管理</h1>
                    <p class="text-muted mb-0">管理系统中的各种ID信息，包括用户ID、设备ID、应用ID等</p>
                </div>
                <div class="col-md-4 text-end">
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addIdModal">
                        <i class="fas fa-plus me-2"></i>添加ID
                    </button>
                </div>
            </div>
        </div>

        <!-- 统计卡片 -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="stats-card text-center">
                    <div class="stats-number" id="totalIds">0</div>
                    <div class="stats-label">总ID数量</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card text-center">
                    <div class="stats-number" id="activeIds">0</div>
                    <div class="stats-label">活跃ID</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card text-center">
                    <div class="stats-number" id="expiredIds">0</div>
                    <div class="stats-label">过期ID</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card text-center">
                    <div class="stats-number" id="pendingIds">0</div>
                    <div class="stats-label">待审核ID</div>
                </div>
            </div>
        </div>

        <!-- ID列表 -->
        <div class="card">
            <div class="card-header">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <h5 class="mb-0"><i class="fas fa-list me-2"></i>ID列表</h5>
                    </div>
                    <div class="col-md-6">
                        <div class="input-group">
                            <input type="text" class="form-control" id="searchInput" placeholder="搜索ID...">
                            <button class="btn btn-outline-secondary" type="button" id="searchBtn">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="selectAllIds"></th>
                                <th>ID名称</th>
                                <th>ID类型</th>
                                <th>状态</th>
                                <th>创建时间</th>
                                <th>过期时间</th>
                                <th>描述</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="idTableBody">
                            <!-- ID数据将通过JavaScript动态加载 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 分页 -->
        <nav aria-label="ID列表分页" class="mt-3">
            <ul class="pagination justify-content-center" id="pagination">
                <!-- 分页将通过JavaScript动态生成 -->
            </ul>
        </nav>
    </div>

    <!-- 添加ID模态框 -->
    <div class="modal fade" id="addIdModal" tabindex="-1" aria-labelledby="addIdModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addIdModalLabel">添加新ID</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addIdForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="idName" class="form-label">ID名称 *</label>
                                    <input type="text" class="form-control" id="idName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="idType" class="form-label">ID类型 *</label>
                                    <select class="form-select" id="idType" required>
                                        <option value="">请选择ID类型</option>
                                        <option value="user">用户ID</option>
                                        <option value="device">设备ID</option>
                                        <option value="app">应用ID</option>
                                        <option value="system">系统ID</option>
                                        <option value="other">其他</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="idStatus" class="form-label">状态</label>
                                    <select class="form-select" id="idStatus">
                                        <option value="active">活跃</option>
                                        <option value="inactive">非活跃</option>
                                        <option value="pending">待审核</option>
                                        <option value="expired">已过期</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="expiryDate" class="form-label">过期时间</label>
                                    <input type="datetime-local" class="form-control" id="expiryDate">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="idDescription" class="form-label">描述</label>
                            <textarea class="form-control" id="idDescription" rows="3" placeholder="请输入ID描述信息..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="saveIdBtn">保存</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 编辑ID模态框 -->
    <div class="modal fade" id="editIdModal" tabindex="-1" aria-labelledby="editIdModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editIdModalLabel">编辑ID</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editIdForm">
                        <input type="hidden" id="editIdId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editIdName" class="form-label">ID名称 *</label>
                                    <input type="text" class="form-control" id="editIdName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editIdType" class="form-label">ID类型 *</label>
                                    <select class="form-select" id="editIdType" required>
                                        <option value="">请选择ID类型</option>
                                        <option value="user">用户ID</option>
                                        <option value="device">设备ID</option>
                                        <option value="app">应用ID</option>
                                        <option value="system">系统ID</option>
                                        <option value="other">其他</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editIdStatus" class="form-label">状态</label>
                                    <select class="form-select" id="editIdStatus">
                                        <option value="active">活跃</option>
                                        <option value="inactive">非活跃</option>
                                        <option value="pending">待审核</option>
                                        <option value="expired">已过期</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editExpiryDate" class="form-label">过期时间</label>
                                    <input type="datetime-local" class="form-control" id="editExpiryDate">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="editIdDescription" class="form-label">描述</label>
                            <textarea class="form-control" id="editIdDescription" rows="3" placeholder="请输入ID描述信息..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="updateIdBtn">更新</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 模拟ID数据
        let idData = [
            {
                id: 1,
                name: "USER_001",
                type: "user",
                status: "active",
                createTime: "2024-01-15 10:30:00",
                expiryTime: "2024-12-31 23:59:59",
                description: "管理员用户ID"
            },
            {
                id: 2,
                name: "DEVICE_001",
                type: "device",
                status: "active",
                createTime: "2024-01-10 14:20:00",
                expiryTime: "2024-11-30 23:59:59",
                description: "主要设备ID"
            },
            {
                id: 3,
                name: "APP_001",
                type: "app",
                status: "pending",
                createTime: "2024-01-20 09:15:00",
                expiryTime: "2024-10-31 23:59:59",
                description: "核心应用ID"
            },
            {
                id: 4,
                name: "SYS_001",
                type: "system",
                status: "expired",
                createTime: "2023-12-01 16:45:00",
                expiryTime: "2024-01-31 23:59:59",
                description: "系统管理ID"
            }
        ];

        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            loadIdData();
            updateStats();
            setupEventListeners();
        });

        // 加载ID数据
        function loadIdData() {
            const tbody = document.getElementById('idTableBody');
            tbody.innerHTML = '';

            idData.forEach(id => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><input type="checkbox" class="id-checkbox" value="${id.id}"></td>
                    <td>${id.name}</td>
                    <td>${getTypeDisplayName(id.type)}</td>
                    <td><span class="status-badge status-${id.status}">${getStatusDisplayName(id.status)}</span></td>
                    <td>${id.createTime}</td>
                    <td>${id.expiryTime}</td>
                    <td>${id.description}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary me-1" onclick="editId(${id.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteId(${id.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // 更新统计信息
        function updateStats() {
            const total = idData.length;
            const active = idData.filter(id => id.status === 'active').length;
            const expired = idData.filter(id => id.status === 'expired').length;
            const pending = idData.filter(id => id.status === 'pending').length;

            document.getElementById('totalIds').textContent = total;
            document.getElementById('activeIds').textContent = active;
            document.getElementById('expiredIds').textContent = expired;
            document.getElementById('pendingIds').textContent = pending;
        }

        // 设置事件监听器
        function setupEventListeners() {
            // 全选功能
            document.getElementById('selectAllIds').addEventListener('change', function() {
                const checkboxes = document.querySelectorAll('.id-checkbox');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = this.checked;
                });
            });

            // 搜索功能
            document.getElementById('searchBtn').addEventListener('click', function() {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                filterIdData(searchTerm);
            });

            // 保存ID
            document.getElementById('saveIdBtn').addEventListener('click', function() {
                saveId();
            });

            // 更新ID
            document.getElementById('updateIdBtn').addEventListener('click', function() {
                updateId();
            });
        }

        // 获取类型显示名称
        function getTypeDisplayName(type) {
            const typeMap = {
                'user': '用户ID',
                'device': '设备ID',
                'app': '应用ID',
                'system': '系统ID',
                'other': '其他'
            };
            return typeMap[type] || type;
        }

        // 获取状态显示名称
        function getStatusDisplayName(status) {
            const statusMap = {
                'active': '活跃',
                'inactive': '非活跃',
                'pending': '待审核',
                'expired': '已过期'
            };
            return statusMap[status] || status;
        }

        // 过滤ID数据
        function filterIdData(searchTerm) {
            const filteredData = idData.filter(id => 
                id.name.toLowerCase().includes(searchTerm) ||
                id.description.toLowerCase().includes(searchTerm) ||
                getTypeDisplayName(id.type).toLowerCase().includes(searchTerm)
            );
            displayFilteredData(filteredData);
        }

        // 显示过滤后的数据
        function displayFilteredData(data) {
            const tbody = document.getElementById('idTableBody');
            tbody.innerHTML = '';

            data.forEach(id => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><input type="checkbox" class="id-checkbox" value="${id.id}"></td>
                    <td>${id.name}</td>
                    <td>${getTypeDisplayName(id.type)}</td>
                    <td><span class="status-badge status-${id.status}">${getStatusDisplayName(id.status)}</span></td>
                    <td>${id.createTime}</td>
                    <td>${id.expiryTime}</td>
                    <td>${id.description}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary me-1" onclick="editId(${id.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteId(${id.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // 保存ID
        function saveId() {
            const name = document.getElementById('idName').value;
            const type = document.getElementById('idType').value;
            const status = document.getElementById('idStatus').value;
            const expiryDate = document.getElementById('expiryDate').value;
            const description = document.getElementById('idDescription').value;

            if (!name || !type) {
                alert('请填写必填字段！');
                return;
            }

            const newId = {
                id: idData.length + 1,
                name: name,
                type: type,
                status: status,
                createTime: new Date().toLocaleString('zh-CN'),
                expiryTime: expiryDate ? new Date(expiryDate).toLocaleString('zh-CN') : '永久',
                description: description
            };

            idData.push(newId);
            loadIdData();
            updateStats();
            
            // 关闭模态框并重置表单
            const modal = bootstrap.Modal.getInstance(document.getElementById('addIdModal'));
            modal.hide();
            document.getElementById('addIdForm').reset();
        }

        // 编辑ID
        function editId(id) {
            const idItem = idData.find(item => item.id === id);
            if (!idItem) return;

            document.getElementById('editIdId').value = idItem.id;
            document.getElementById('editIdName').value = idItem.name;
            document.getElementById('editIdType').value = idItem.type;
            document.getElementById('editIdStatus').value = idItem.status;
            document.getElementById('editExpiryDate').value = idItem.expiryTime !== '永久' ? idItem.expiryTime.replace(' ', 'T') : '';
            document.getElementById('editIdDescription').value = idItem.description;

            const modal = new bootstrap.Modal(document.getElementById('editIdModal'));
            modal.show();
        }

        // 更新ID
        function updateId() {
            const id = parseInt(document.getElementById('editIdId').value);
            const name = document.getElementById('editIdName').value;
            const type = document.getElementById('editIdType').value;
            const status = document.getElementById('editIdStatus').value;
            const expiryDate = document.getElementById('editExpiryDate').value;
            const description = document.getElementById('editIdDescription').value;

            if (!name || !type) {
                alert('请填写必填字段！');
                return;
            }

            const index = idData.findIndex(item => item.id === id);
            if (index !== -1) {
                idData[index] = {
                    ...idData[index],
                    name: name,
                    type: type,
                    status: status,
                    expiryTime: expiryDate ? new Date(expiryDate).toLocaleString('zh-CN') : '永久',
                    description: description
                };

                loadIdData();
                updateStats();
                
                // 关闭模态框
                const modal = bootstrap.Modal.getInstance(document.getElementById('editIdModal'));
                modal.hide();
            }
        }

        // 删除ID
        function deleteId(id) {
            if (confirm('确定要删除这个ID吗？')) {
                idData = idData.filter(item => item.id !== id);
                loadIdData();
                updateStats();
            }
        }
    </script>
</body>
</html> 